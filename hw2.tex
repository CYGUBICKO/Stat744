\documentclass[]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\usepackage{fixltx2e} % provides \textsubscript
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
\else % if luatex or xelatex
  \ifxetex
    \usepackage{mathspec}
  \else
    \usepackage{fontspec}
  \fi
  \defaultfontfeatures{Ligatures=TeX,Scale=MatchLowercase}
\fi
% use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
% use microtype if available
\IfFileExists{microtype.sty}{%
\usepackage{microtype}
\UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\usepackage[margin=1in]{geometry}
\usepackage{hyperref}
\hypersetup{unicode=true,
            pdftitle={STATS 744: Homework 2},
            pdfauthor={Steve Cygu},
            pdfborder={0 0 0},
            breaklinks=true}
\urlstyle{same}  % don't use monospace font for urls
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
\IfFileExists{parskip.sty}{%
\usepackage{parskip}
}{% else
\setlength{\parindent}{0pt}
\setlength{\parskip}{6pt plus 2pt minus 1pt}
}
\setlength{\emergencystretch}{3em}  % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{0}
% Redefines (sub)paragraphs to behave more like sections
\ifx\paragraph\undefined\else
\let\oldparagraph\paragraph
\renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
\let\oldsubparagraph\subparagraph
\renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

%%% Use protect on footnotes to avoid problems with footnotes in titles
\let\rmarkdownfootnote\footnote%
\def\footnote{\protect\rmarkdownfootnote}

%%% Change title format to be more compact
\usepackage{titling}

% Create subtitle command for use in maketitle
\providecommand{\subtitle}[1]{
  \posttitle{
    \begin{center}\large#1\end{center}
    }
}

\setlength{\droptitle}{-2em}

  \title{STATS 744: Homework 2}
    \pretitle{\vspace{\droptitle}\centering\huge}
  \posttitle{\par}
    \author{Steve Cygu}
    \preauthor{\centering\large\emph}
  \postauthor{\par}
      \predate{\centering\large\emph}
  \postdate{\par}
    \date{19 September 2019}


\begin{document}
\maketitle

\textbf{Write a short statement (a few sentences) that explains what
question you think the graphic is trying to answer, or what pattern it's
trying to display}

\begin{itemize}
\tightlist
\item
  The graph is trying to display the trends in reported cases of various
  diseases in the US, before and after the respective vaccines were
  introduced, from 1945 to 2015. In particular, the graph is showing how
  the number of reported cases have managed to ``decrease'' after the
  introduction of the vaccine(s) for the respective diseases.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Set global options}
\NormalTok{knitr}\OperatorTok{::}\NormalTok{opts_chunk}\OperatorTok{$}\KeywordTok{set}\NormalTok{(}\DataTypeTok{echo =} \OtherTok{TRUE}
\NormalTok{   , }\DataTypeTok{warning =} \OtherTok{FALSE}
\NormalTok{   , }\DataTypeTok{message =} \OtherTok{FALSE}
\NormalTok{   , }\DataTypeTok{fig.width =} \DecValTok{10}
\NormalTok{   , }\DataTypeTok{fig.height =} \DecValTok{8}
\NormalTok{   , }\DataTypeTok{results =} \StringTok{"asis"}\NormalTok{)}
\KeywordTok{options}\NormalTok{(}\DataTypeTok{width =} \DecValTok{12}\NormalTok{)}

\CommentTok{## Install or load required packages}
\NormalTok{pkgs <-}\StringTok{ }\KeywordTok{c}\NormalTok{(}\StringTok{"MASS"}\NormalTok{, }\StringTok{"ggplot2"}
\NormalTok{    , }\StringTok{"readr"}\NormalTok{, }\StringTok{"DT"}
\NormalTok{    , }\StringTok{"data.table"}\NormalTok{, }\StringTok{"dplyr"}
\NormalTok{    , }\StringTok{"tibble"}\NormalTok{, }\StringTok{"splines"}
\NormalTok{    , }\StringTok{"directlabels"}\NormalTok{, }\StringTok{"scales"}
\NormalTok{    , }\StringTok{"colorspace"}
\NormalTok{)}
\ControlFlowTok{if}\NormalTok{ (}\OperatorTok{!}\StringTok{"pacman"} \OperatorTok{%in%}\StringTok{ }\KeywordTok{installed.packages}\NormalTok{()[,}\DecValTok{1}\NormalTok{])\{}
    \KeywordTok{install.packages}\NormalTok{(}\StringTok{"pacman"}\NormalTok{)}
\NormalTok{\}}
\NormalTok{pacman}\OperatorTok{::}\KeywordTok{p_load}\NormalTok{(pkgs, }\DataTypeTok{install =} \OtherTok{TRUE}\NormalTok{, }\DataTypeTok{character.only =} \OtherTok{TRUE}\NormalTok{)}

\KeywordTok{theme_set}\NormalTok{(}\KeywordTok{theme_bw}\NormalTok{() }\OperatorTok{+}\StringTok{ }
\StringTok{    }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{panel.spacing=}\NormalTok{grid}\OperatorTok{::}\KeywordTok{unit}\NormalTok{(}\DecValTok{0}\NormalTok{,}\StringTok{"lines"}\NormalTok{))) }
\end{Highlighting}
\end{Shaded}

\hypertarget{downloading-data-and-some-checks}{%
\subsection{Downloading data and some
checks}\label{downloading-data-and-some-checks}}

The script below will, if data doesn't exist in the local directory,
automatically downlad the data and load it, otherwise load it.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{## ---- Create Output folder ----}

\NormalTok{dirs <-}\StringTok{ }\KeywordTok{list.dirs}\NormalTok{(}\StringTok{"."}\NormalTok{)}
\NormalTok{dirname <-}\StringTok{ "HW2"}
\ControlFlowTok{if}\NormalTok{ (}\KeywordTok{length}\NormalTok{(dirs)}\OperatorTok{>}\DecValTok{1} \OperatorTok{&}\StringTok{ }\KeywordTok{sum}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(dirname, dirs, }\DataTypeTok{ignore.cas =} \OtherTok{TRUE}\NormalTok{))}\OperatorTok{==}\DecValTok{0}\NormalTok{)\{}
    \KeywordTok{dir.create}\NormalTok{(}\KeywordTok{paste0}\NormalTok{(}\StringTok{"./"}\NormalTok{, dirname))}
\NormalTok{\}}

\CommentTok{#### ---- Downloading the data ----}

\CommentTok{# The code below will automatically download the data from the specified url}

\CommentTok{## Download the datasets and the labels}
\NormalTok{df_url <-}\StringTok{ "https://bbolker.github.io/stat744/data/vaccine_data_online.csv"}

\CommentTok{# Check if the dataset already exist}
\NormalTok{pattern <-}\StringTok{ "vaccine_data"} \CommentTok{# How is the dataset named in the computer?}
\ControlFlowTok{if}\NormalTok{(}\KeywordTok{length}\NormalTok{(}\KeywordTok{list.files}\NormalTok{(}\StringTok{"."}\NormalTok{))}\OperatorTok{>}\DecValTok{0} \OperatorTok{&}\StringTok{ }\KeywordTok{sum}\NormalTok{(}\KeywordTok{grepl}\NormalTok{(pattern, }\KeywordTok{list.files}\NormalTok{(}\StringTok{"."}\NormalTok{), }\DataTypeTok{ignore.case =} \OtherTok{TRUE}\NormalTok{))}\OperatorTok{==}\DecValTok{1}\NormalTok{)\{}
\NormalTok{    df_name <-}\StringTok{ }\KeywordTok{grep}\NormalTok{(pattern, }\KeywordTok{list.files}\NormalTok{(), }\DataTypeTok{value =}\NormalTok{ T)}
    \KeywordTok{print}\NormalTok{(}\StringTok{"Reading dataset from your computer... }\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{    working_df <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(df_name)}
    \KeywordTok{cat}\NormalTok{(df_name, }\StringTok{" dataset already saved!!! We'll proceed to analysis."}\NormalTok{, }\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{\} }\ControlFlowTok{else}\NormalTok{ \{}
    \CommentTok{# Download data}
    \KeywordTok{cat}\NormalTok{(}\StringTok{"Dowloading dataset from "}\NormalTok{, df_url, }\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{"}\NormalTok{)}
\NormalTok{    vaccine_df <-}\StringTok{ }\KeywordTok{read_csv}\NormalTok{(df_url)}
    \KeywordTok{write.csv}\NormalTok{(vaccine_df, }\StringTok{"vaccine_data.csv"}\NormalTok{, }\DataTypeTok{row.names =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{    working_df <-}\StringTok{ }\NormalTok{vaccine_df}
    \KeywordTok{cat}\NormalTok{(pattern}
\NormalTok{        , }\StringTok{" didn't exist!!! We've downloaded data from the url "}
\NormalTok{        , df_url, }\StringTok{"}\CharTok{\textbackslash{}n}\StringTok{ Dataset dim: "}
\NormalTok{        , }\KeywordTok{dim}\NormalTok{(vaccine_df)}
\NormalTok{    )}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

{[}1{]} ``Reading dataset from your computer\ldots{} \n''
vaccine\_data.csv dataset already saved!!! We'll proceed to analysis.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{print}\NormalTok{(}\KeywordTok{getwd}\NormalTok{())}
\end{Highlighting}
\end{Shaded}

{[}1{]} ``/home/steve/grive/McMaster/PhD/Courses/STATS744/Stat744''

The table below summarizes the number, \texttt{no\_miss} (and also
expressed as proportions, \texttt{prop\_miss}) of missing cases in each
of the variables. For this exploration, we are only interested
\texttt{cases}, \texttt{disease} and \texttt{year}.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{miss_df <-}\StringTok{ }\NormalTok{(}\KeywordTok{sapply}\NormalTok{(working_df, }\ControlFlowTok{function}\NormalTok{(x)\{}\KeywordTok{sum}\NormalTok{(}\KeywordTok{is.na}\NormalTok{(x) }\OperatorTok{|}\StringTok{ }\NormalTok{x}\OperatorTok{==}\StringTok{""}\NormalTok{)\})}
    \OperatorTok{%>%}\StringTok{ }\KeywordTok{data.frame}\NormalTok{()}
    \OperatorTok{%>%}\StringTok{ }\KeywordTok{rownames_to_column}\NormalTok{(}\StringTok{"variables"}\NormalTok{)}
    \OperatorTok{%>%}\StringTok{ }\KeywordTok{setnames}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\StringTok{"."}\NormalTok{), }\KeywordTok{c}\NormalTok{(}\StringTok{"no_miss"}\NormalTok{))}
    \OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\StringTok{`}\DataTypeTok{prop_miss (%)}\StringTok{`}\NormalTok{ =}\StringTok{ }\KeywordTok{round}\NormalTok{(no_miss }\OperatorTok{*}\StringTok{ }\DecValTok{100}\OperatorTok{/}\KeywordTok{nrow}\NormalTok{(working_df), }\DecValTok{2}\NormalTok{))}
    \OperatorTok{%>%}\StringTok{ }\KeywordTok{datatable}\NormalTok{(}\DataTypeTok{rownames =} \OtherTok{FALSE}\NormalTok{)}
\NormalTok{)}
\NormalTok{miss_df}
\end{Highlighting}
\end{Shaded}

TypeError: Attempting to change the setter of an unconfigurable
property. TypeError: Attempting to change the setter of an
unconfigurable property.
\includegraphics{hw2_files/figure-latex/missingness-1.pdf}

We calculate the proportion of reported cases per year per disease.
Also, extract the reported cases at the time when vaccine was
introduced.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Create vaccine variable and also calculate the proportion of cases per year}
\NormalTok{working_df <-}\StringTok{ }\NormalTok{(working_df}
    \OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{vac =} \KeywordTok{ifelse}\NormalTok{(vaccine }\OperatorTok{!=}\StringTok{ "FALSE"}\NormalTok{, cases, }\OtherTok{NA}\NormalTok{)}
\NormalTok{        , }\DataTypeTok{cases =} \KeywordTok{ifelse}\NormalTok{(cases }\OperatorTok{>}\StringTok{ }\DecValTok{0}\NormalTok{, cases, }\OtherTok{NA}\NormalTok{)}
\NormalTok{        , }\DataTypeTok{vaccine =} \KeywordTok{ifelse}\NormalTok{(vaccine }\OperatorTok{==}\StringTok{ "FALSE"} \OperatorTok{|}\StringTok{ }\NormalTok{cases }\OperatorTok{<=}\StringTok{ }\DecValTok{0}\NormalTok{, }\OtherTok{NA}\NormalTok{, }\KeywordTok{as.character}\NormalTok{(vaccine))}
\NormalTok{        , }\DataTypeTok{disease =} \KeywordTok{reorder}\NormalTok{(disease, cases, }\DataTypeTok{FUN =} \ControlFlowTok{function}\NormalTok{(x) }\OperatorTok{-}\NormalTok{x[}\DecValTok{1}\NormalTok{])}
\NormalTok{    )}
    \OperatorTok{%>%}\StringTok{ }\KeywordTok{group_by}\NormalTok{(year)}
    \OperatorTok{%>%}\StringTok{ }\KeywordTok{mutate}\NormalTok{(}\DataTypeTok{prop_cases =} \KeywordTok{round}\NormalTok{(cases}\OperatorTok{/}\KeywordTok{sum}\NormalTok{(cases), }\DecValTok{2}\NormalTok{))}
\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{data-vizualisation}{%
\subsection{Data vizualisation}\label{data-vizualisation}}

\textbf{Explain (in a few sentences) why your graph or graphs answer the
question better than the original grap}

\begin{itemize}
\tightlist
\item
  Although the original graph can also show the differences in number of
  reported cases over time, the viewer has to visually compare (switch
  between the bubbles) the sizes of the bubbles (of which, some
  overlayed) to conceptualise the trends. On the contrary, the line
  graph below (first graph) easily provides the reader with the general
  trends in the number of cases over time by simply comparing the
  positions along \texttt{x} and \texttt{y} cordinates. The second
  figure (below), provides a better way to compare the cases per disease
  because they (diseases) are sorted by maximun number of cases
  reported, thus the reader can easily scan and compare the trend
  through time.
\item
  In addition, the vaccines (represented by shapes) in our graphs are
  scaled proportional to the number of cases reported per disease within
  a specific year (this is the same for the data points in the second
  plot). Hence the reader can easily compare the number of cases per
  year for different diseases by just looking at the sizes of the dots
  and also identify, through time, when the vaccine was introduced.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vaccine_plot1 <-}\StringTok{ }\NormalTok{(}\KeywordTok{ggplot}\NormalTok{(working_df, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ year, }\DataTypeTok{y =}\NormalTok{ cases, }\DataTypeTok{colour =}\NormalTok{ disease, }\DataTypeTok{group =}\NormalTok{ disease))}
    \OperatorTok{+}\StringTok{ }\KeywordTok{geom_line}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{lty =}\NormalTok{ disease))}
    \OperatorTok{+}\StringTok{ }\KeywordTok{geom_point}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ vac, }\DataTypeTok{size =}\NormalTok{ prop_cases, }\DataTypeTok{group =}\NormalTok{ vaccine, }\DataTypeTok{shape =}\NormalTok{ vaccine))}
    \OperatorTok{+}\StringTok{ }\KeywordTok{scale_shape_manual}\NormalTok{(}\DataTypeTok{values=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nlevels}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(working_df}\OperatorTok{$}\NormalTok{vaccine)), }\DataTypeTok{na.translate =} \OtherTok{FALSE}\NormalTok{)}
    \OperatorTok{+}\StringTok{ }\KeywordTok{expand_limits}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{c}\NormalTok{(}\DecValTok{1945}\NormalTok{, }\DecValTok{2020}\NormalTok{), }\DataTypeTok{y =} \KeywordTok{c}\NormalTok{(}\DecValTok{10}\OperatorTok{^}\NormalTok{(}\OperatorTok{-}\DecValTok{2}\NormalTok{), }\DecValTok{10}\OperatorTok{^}\DecValTok{7}\NormalTok{))}
    \OperatorTok{+}\StringTok{ }\KeywordTok{scale_x_continuous}\NormalTok{(}\DataTypeTok{breaks =} \KeywordTok{seq}\NormalTok{(}\DecValTok{1945}\NormalTok{, }\DecValTok{2015}\NormalTok{, }\DecValTok{10}\NormalTok{))}
    \OperatorTok{+}\StringTok{ }\KeywordTok{scale_y_log10}\NormalTok{(}\DataTypeTok{breaks =} \KeywordTok{trans_breaks}\NormalTok{(}\StringTok{"log10"}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(x) }\DecValTok{10}\OperatorTok{^}\NormalTok{x)}
\NormalTok{        , }\DataTypeTok{labels =} \KeywordTok{trans_format}\NormalTok{(}\StringTok{"log10"}\NormalTok{, }\KeywordTok{math_format}\NormalTok{(}\DecValTok{10}\OperatorTok{^}\NormalTok{.x))}
\NormalTok{    )}
    \OperatorTok{+}\StringTok{ }\KeywordTok{scale_colour_discrete_qualitative}\NormalTok{()}
    \OperatorTok{+}\StringTok{ }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x =} \StringTok{"Years"}
\NormalTok{        , }\DataTypeTok{y =} \StringTok{"Reported cases"}
\NormalTok{        , }\DataTypeTok{title =} \StringTok{"Number of reported cases of various diseases in the US from 1945 to 2015"}
\NormalTok{        , }\DataTypeTok{shape =} \StringTok{"Vaccines"}
\NormalTok{    )}
    \OperatorTok{+}\StringTok{ }\KeywordTok{guides}\NormalTok{(}\DataTypeTok{color =} \OtherTok{FALSE}
\NormalTok{        , }\DataTypeTok{size =} \OtherTok{FALSE}
\NormalTok{        , }\DataTypeTok{lty =} \OtherTok{FALSE}
\NormalTok{        , }\DataTypeTok{shape =} \KeywordTok{guide_legend}\NormalTok{(}\DataTypeTok{nrow =} \DecValTok{8}\NormalTok{, }\DataTypeTok{byrow =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{    )}
    \OperatorTok{+}\StringTok{ }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{legend.position=}\StringTok{"bottom"}
\NormalTok{        , }\DataTypeTok{legend.direction =} \StringTok{"vertical"}
\NormalTok{        , }\DataTypeTok{legend.text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \FloatTok{7.5}\NormalTok{)}
\NormalTok{        , }\DataTypeTok{legend.key.size =} \KeywordTok{unit}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\StringTok{"cm"}\NormalTok{)}
\NormalTok{        , }\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{0.5}\NormalTok{)}
\NormalTok{    )}
    \OperatorTok{+}\StringTok{ }\KeywordTok{geom_dl}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{label =}\NormalTok{ disease), }\DataTypeTok{method =} \StringTok{"last.bumpup"}\NormalTok{, }\DataTypeTok{cex =} \DecValTok{1}\NormalTok{)}
\NormalTok{)}
\KeywordTok{print}\NormalTok{(vaccine_plot1)}
\end{Highlighting}
\end{Shaded}

\includegraphics{hw2_files/figure-latex/datviz_plot1-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{vaccine_plot2 <-}\StringTok{ }\NormalTok{(}\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ working_df, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ year, }\DataTypeTok{y =}\NormalTok{ cases))}
    \OperatorTok{+}\StringTok{ }\KeywordTok{geom_point}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{size =}\NormalTok{ prop_cases), }\DataTypeTok{alpha =} \FloatTok{0.3}\NormalTok{)}
    \OperatorTok{+}\StringTok{ }\KeywordTok{scale_size_area}\NormalTok{()}
    \OperatorTok{+}\StringTok{ }\KeywordTok{geom_point}\NormalTok{(}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{y =}\NormalTok{ vac, }\DataTypeTok{size =}\NormalTok{ prop_cases, }\DataTypeTok{group =}\NormalTok{ vaccine, }\DataTypeTok{shape =}\NormalTok{ vaccine))}
    \OperatorTok{+}\StringTok{ }\KeywordTok{scale_shape_manual}\NormalTok{(}\DataTypeTok{values=}\DecValTok{1}\OperatorTok{:}\KeywordTok{nlevels}\NormalTok{(}\KeywordTok{as.factor}\NormalTok{(working_df}\OperatorTok{$}\NormalTok{vaccine)), }\DataTypeTok{na.translate =} \OtherTok{FALSE}\NormalTok{)}
    \OperatorTok{+}\StringTok{ }\KeywordTok{scale_x_continuous}\NormalTok{(}\DataTypeTok{lim =} \KeywordTok{c}\NormalTok{(}\DecValTok{1945}\NormalTok{, }\DecValTok{2015}\NormalTok{), }\DataTypeTok{breaks =} \KeywordTok{seq}\NormalTok{(}\DecValTok{1950}\NormalTok{, }\DecValTok{2015}\NormalTok{, }\DecValTok{10}\NormalTok{))}
    \OperatorTok{+}\StringTok{ }\KeywordTok{scale_y_log10}\NormalTok{(}\DataTypeTok{breaks =} \KeywordTok{trans_breaks}\NormalTok{(}\StringTok{"log10"}\NormalTok{, }\ControlFlowTok{function}\NormalTok{(x) }\DecValTok{10}\OperatorTok{^}\NormalTok{x)}
\NormalTok{        , }\DataTypeTok{labels =} \KeywordTok{trans_format}\NormalTok{(}\StringTok{"log10"}\NormalTok{, }\KeywordTok{math_format}\NormalTok{(}\DecValTok{10}\OperatorTok{^}\NormalTok{.x))}
\NormalTok{    )}
    \OperatorTok{+}\StringTok{ }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method=}\NormalTok{rlm, }\DataTypeTok{formula=}\NormalTok{y}\OperatorTok{~}\KeywordTok{ns}\NormalTok{(x,}\DecValTok{4}\NormalTok{), }\DataTypeTok{size =} \DecValTok{1}\NormalTok{)}
    \OperatorTok{+}\StringTok{ }\KeywordTok{facet_wrap}\NormalTok{(}\DataTypeTok{facets =} \KeywordTok{vars}\NormalTok{(disease))}
    \OperatorTok{+}\StringTok{ }\KeywordTok{labs}\NormalTok{(}\DataTypeTok{x =} \StringTok{"Years"}
\NormalTok{        , }\DataTypeTok{y =} \StringTok{"Reported cases"}
\NormalTok{        , }\DataTypeTok{title =} \StringTok{"Number of reported cases of various diseases in the US from 1945 to 2015"}
\NormalTok{        , }\DataTypeTok{size =} \StringTok{"Proportions"}
\NormalTok{        , }\DataTypeTok{shape =} \StringTok{"Vaccines"}
\NormalTok{    )}
    \OperatorTok{+}\StringTok{ }\KeywordTok{guides}\NormalTok{(}\DataTypeTok{color =} \OtherTok{FALSE}
\NormalTok{        , }\DataTypeTok{shape =} \KeywordTok{guide_legend}\NormalTok{(}\DataTypeTok{nrow =} \DecValTok{8}\NormalTok{, }\DataTypeTok{byrow =} \OtherTok{TRUE}\NormalTok{)}
\NormalTok{    )}
    \OperatorTok{+}\StringTok{ }\KeywordTok{theme}\NormalTok{(}\DataTypeTok{legend.position=}\StringTok{"bottom"}
\NormalTok{        , }\DataTypeTok{legend.direction =} \StringTok{"vertical"}
\NormalTok{        , }\DataTypeTok{legend.text =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{size =} \FloatTok{7.3}\NormalTok{)}
\NormalTok{        , }\DataTypeTok{legend.key.size =} \KeywordTok{unit}\NormalTok{(}\FloatTok{0.1}\NormalTok{, }\StringTok{"cm"}\NormalTok{)}
\NormalTok{        , }\DataTypeTok{plot.title =} \KeywordTok{element_text}\NormalTok{(}\DataTypeTok{hjust =} \FloatTok{0.5}\NormalTok{)}
\NormalTok{    )}
\NormalTok{)}
\KeywordTok{print}\NormalTok{(vaccine_plot2)}
\end{Highlighting}
\end{Shaded}

\includegraphics{hw2_files/figure-latex/datviz_plot2-1.pdf}


\end{document}
